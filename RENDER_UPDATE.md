# Обновление образа на Render.com

## Текущий статус

Ваше приложение развернуто и работает:
- **URL**: https://ikap1-backend-latest.onrender.com
- **Node.js сервер**: работает на порту 10000 (автоматически определен Render)
- **Python Flask**: работает на порту 5000
- **База данных**: подключена (Supabase PostgreSQL)

## Что было исправлено

1. ✅ Flask debug режим отключен в production
2. ✅ PORT теперь берется из переменной окружения (Render автоматически устанавливает)
3. ✅ Добавлена переменная `FLASK_DEBUG=False` для production

## Обновление образа на Render

После исправлений нужно пересобрать и обновить образ:

### 1. Пересоберите образ локально

```bash
docker build --platform linux/amd64 -t mshaim001/ikap1-backend:latest .
```

### 2. Опубликуйте обновленный образ

```bash
docker push mshaim001/ikap1-backend:latest
```

### 3. На Render.com

Render автоматически подхватит обновление, или:

1. Зайдите в ваш сервис на Render
2. Нажмите **Manual Deploy** → **Deploy latest commit**
3. Или просто подождите - Render может автоматически проверить обновления

## Переменные окружения на Render

Убедитесь что установлены:

```env
NODE_ENV=production
FLASK_DEBUG=False
PYTHON_PORT=5000
OPENAI_API_KEY=your_key
DATABASE_URL=your_database_url
```

**Важно**: Не устанавливайте `PORT` вручную - Render автоматически установит свой порт (обычно 10000).

## Проверка работы

После обновления проверьте логи:

1. Зайдите в **Logs** на Render
2. Убедитесь что:
   - ✅ Flask запускается без предупреждения о debug режиме
   - ✅ Node.js сервер слушает на правильном порту
   - ✅ Оба сервиса запущены

## Текущие логи показывают

✅ **Работает:**
- Node.js сервер запущен на порту 10000
- Python Flask запущен на порту 5000
- База данных подключена
- MCP сервер запущен
- Python зависимости установлены

⚠️ **Исправлено в новой версии:**
- Flask debug режим отключен
- PORT берется из переменных окружения

## Если нужно перезапустить вручную

На Render.com:
1. Settings → **Manual Deploy**
2. Выберите **Deploy latest commit**
3. Или используйте кнопку **Restart** в меню

